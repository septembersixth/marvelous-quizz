

<div class="front-flashMessenger">
    <?= $this->flashMessenger()->render('default', ['alert', 'alert-dismissible', 'alert-success']); ?>
    <?= $this->flashMessenger()->render('success', ['alert', 'alert-dismissible', 'alert-success']); ?>
    <?= $this->flashMessenger()->render('error', ['alert', 'alert-dismissible', 'alert-danger']); ?>
</div>


    <div ng-controller="quizzController as ctrl" class="container container-main">

        <div class="image-container">
            <img ng-src={{'img/upload/'+ctrl.getCurrentTest().image}} class="row test-image" />

            <div ng-show="ctrl.state === 1" class="explanation-row">
                <div class="explanation">
                    {{ctrl.getCurrentTest().explanation}}
                    <p>r√©ponse : {{ctrl.getCurrentTest().solutions | optionsMappingFilter : ctrl.optionsMapping}}</p>
                </div>
            </div>
        </div>

        <div ng-class="{'alert-success': ctrl.validator.valid, 'alert-danger': ! ctrl.validator.valid, 'visible': ctrl.state, 'visible-hidden': ! ctrl.state }"
             class="msg alert"
             id="msg-answer"
             role="alert">
            {{ctrl.validator.valid | validation}}
        </div>

        <div class="pull-right">{{ctrl.collector.correct}} / {{ctrl.collector.count}}</div>
        <div class="clearfix"></div>

        <div class="questions">
            <div ng-repeat="question in ctrl.getCurrentTest().questions">
            {{question.text}}
            <ul>
                <li class="option" ng-repeat="option in question.options"
                    ng-class="{active: ctrl.isActiveOption(option.id), correct: ctrl.state && ctrl.isCorrectOption(option.id)}"
                    >
                    <div ng-click="ctrl.addAnswer(option.id)">
                        <button class="button-option">{{ctrl.optionsMapping[option.id]}}</button>
                        {{option.text}}
                    </div>
                </li>
            </ul>
            </div>
        </div>

        <button id="button-next" ng-click="ctrl.nextTest()" class="btn pull-right" ng-class="{'btn-info': ! ctrl.state, 'btn-success': ctrl.state}">
            {{ctrl.state | next}} <span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span>
        </button>

    </div>


<script>
    (function(){
        'use strict';
        angular.module('testsInitService', [])
            .factory('getTestsJsonService', function(){
                return function() {
                    return <?= $testsJson ?>;
                }
            })
        ;
    })();
</script>